#!/usr/bin/env python3
from pwn import *

# setting the context
context.terminal = ['tmux', 'splitw', '-h']
context.arch = "amd64"
binary = '/fuzz/exif/install_dbg/bin/exif'
context.binary = binary
elf = ELF(binary)
arg = 'id0017'


#b 535
#b 1354
# b *exif_entry_get_value
# b *exif_convert_utf16_to_utf8
if args.GDB:
    p = gdb.debug(args=[binary,arg],gdbscript='''
    b *show_entry_list
    b *exif_entry_format_value
    ''')
else:
    p = elf.process(argv=[arg])



p.interactive()
print(p.clean().decode())
